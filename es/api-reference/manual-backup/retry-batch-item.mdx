---
title: 'POST /invoices/batches/{id}/items/{itemId}/retry - Reintentar Item de Lote'
description: 'Documentaci√≥n para reintentar un item fallido de un lote'
---

# üîÑ POST /invoices/batches/{id}/items/{itemId}/retry - Reintentar Item de Lote

Este endpoint te permite reintentar el procesamiento de un item espec√≠fico que fall√≥ en un lote.

## URL Base

```
https://facture.ar/api/invoices/batches/{id}/items/{itemId}/retry
```

## Autenticaci√≥n

Todas las peticiones requieren autenticaci√≥n usando:

- **Sesi√≥n Web**: Para aplicaciones basadas en navegador
- **API Key**: Para integraciones servidor a servidor

Incluye tu API key en el header `x-api-key`:

```bash
x-api-key: tu-api-key-aqui
```

## Par√°metros de Ruta

| Par√°metro | Tipo | Requerido | Descripci√≥n | Ejemplo |
| --------- | ---- | --------- | ----------- | ------- |
| `id`      | string | ‚úÖ        | ID √∫nico del lote | `"123e4567-e89b-12d3-a456-426614174000"` |
| `itemId`  | string | ‚úÖ        | ID √∫nico del item a reintentar | `"456e7890-e89b-12d3-a456-426614174001"` |

## Respuesta

### √âxito (200)

```json
{
  "success": true,
  "message": "Item reintentado exitosamente",
  "itemId": "456e7890-e89b-12d3-a456-426614174001",
  "batchId": "123e4567-e89b-12d3-a456-426614174000",
  "status": "pending",
  "manualRetryCount": 1,
  "updatedAt": "2024-01-01T10:05:00Z"
}
```

### Respuestas de Error

#### Lote No Encontrado (404)

```json
{
  "error": "Lote no encontrado",
  "details": "The requested batch does not exist"
}
```

#### Item No Encontrado (404)

```json
{
  "error": "Item del lote no encontrado",
  "details": "The requested item does not exist in this batch"
}
```

#### No Autorizado (403)

```json
{
  "error": "No autorizado",
  "details": "You don't have access to this batch"
}
```

#### Item No en Estado de Error (400)

```json
{
  "error": "Solo se pueden reintentar items que est√°n en estado de error. El item est√° en estado: completed",
  "details": "Only items with error status can be retried"
}
```

#### L√≠mite de Reintentos Excedido (429)

```json
{
  "error": "Se ha alcanzado el l√≠mite m√°ximo de reintentos manuales",
  "details": "Maximum manual retry limit reached"
}
```

## Restricciones

- **Estado del Item**: Solo se pueden reintentar items en estado `error`
- **L√≠mite de Reintentos**: M√°ximo 3 reintentos manuales por item
- **Acceso**: Solo el propietario del lote puede reintentar items
- **Lote V√°lido**: El lote debe existir y pertenecer al usuario

## Estados de Item V√°lidos para Reintento

| Estado | Permite Reintento |
| ------ | ----------------- |
| `error` | ‚úÖ S√≠ |
| `pending` | ‚ùå No |
| `processing` | ‚ùå No |
| `completed` | ‚ùå No |

## L√≠mites de Reintento

| Tipo | L√≠mite | Descripci√≥n |
| ---- | ------ | ----------- |
| Reintentos Manuales | 3 | M√°ximo n√∫mero de reintentos manuales por item |
| Reintentos Autom√°ticos | 5 | M√°ximo n√∫mero de reintentos autom√°ticos del sistema |

## Ejemplos de Uso

### Reintentar Item

```bash
curl -X POST https://facture.ar/api/invoices/batches/123e4567-e89b-12d3-a456-426614174000/items/456e7890-e89b-12d3-a456-426614174001/retry \
  -H "Content-Type: application/json" \
  -H "x-api-key: tu-api-key"
```

### JavaScript/Node.js

```javascript
// Reintentar un item espec√≠fico
const response = await fetch('https://facture.ar/api/invoices/batches/123e4567-e89b-12d3-a456-426614174000/items/456e7890-e89b-12d3-a456-426614174001/retry', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'x-api-key': 'tu-api-key',
  },
});

const result = await response.json();
console.log('Resultado del reintento:', result);

if (result.success) {
  console.log(`Item ${result.itemId} reintentado exitosamente`);
  console.log(`Reintentos manuales: ${result.manualRetryCount}`);
}
```

### Python

```python
import requests

# Reintentar un item espec√≠fico
response = requests.post(
    'https://facture.ar/api/invoices/batches/123e4567-e89b-12d3-a456-426614174000/items/456e7890-e89b-12d3-a456-426614174001/retry',
    headers={
        'Content-Type': 'application/json',
        'x-api-key': 'tu-api-key'
    }
)

result = response.json()
print('Resultado del reintento:', result)

if result.get('success'):
    print(f"Item {result['itemId']} reintentado exitosamente")
    print(f"Reintentos manuales: {result['manualRetryCount']}")
```

### Funci√≥n Helper para Reintentar M√∫ltiples Items

```javascript
async function retryFailedItems(batchId, failedItems) {
  const results = [];
  
  for (const item of failedItems) {
    try {
      const response = await fetch(`https://facture.ar/api/invoices/batches/${batchId}/items/${item.id}/retry`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'x-api-key': 'tu-api-key',
        },
      });
      
      const result = await response.json();
      results.push({
        itemId: item.id,
        success: result.success,
        message: result.message
      });
    } catch (error) {
      results.push({
        itemId: item.id,
        success: false,
        error: error.message
      });
    }
  }
  
  return results;
}

// Uso
const failedItems = [
  { id: '456e7890-e89b-12d3-a456-426614174001' },
  { id: '789e0123-e89b-12d3-a456-426614174002' }
];

const results = await retryFailedItems('123e4567-e89b-12d3-a456-426614174000', failedItems);
console.log('Resultados de reintentos:', results);
```

## ‚ùì Soluci√≥n de Problemas

<Accordion title="Error: Item no en estado de error">
**Causa**: Intentas reintentar un item que no est√° en estado de error.

**Soluci√≥n**:

1. Verifica el estado actual del item
2. Solo se pueden reintentar items en estado `error`
3. Los items en estado `completed` no necesitan reintento
</Accordion>

<Accordion title="Error: L√≠mite de reintentos excedido">
**Causa**: Has alcanzado el l√≠mite m√°ximo de reintentos manuales para este item.

**Soluci√≥n**:

1. Verifica cu√°ntos reintentos manuales has realizado
2. El l√≠mite es de 3 reintentos manuales por item
3. Considera revisar y corregir los datos del item antes de reintentar
</Accordion>

<Accordion title="Error: Item no encontrado">
**Causa**: El ID del item no existe en el lote especificado.

**Soluci√≥n**:

1. Verifica que el ID del item sea correcto
2. Aseg√∫rate de que el item pertenezca al lote especificado
3. Consulta la lista de items del lote para obtener los IDs correctos
</Accordion>

## üìû Soporte

Para soporte t√©cnico o preguntas sobre la API:

- üìß **Email**: support@facture.ar
- üí¨ **Chat**: Disponible en la plataforma
- üìö **Documentaci√≥n**: Explora nuestros ejemplos detallados
- üé• **Videollamada**: Para asistencia personalizada
