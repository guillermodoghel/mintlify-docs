---
title: 'GET /invoices/batches/{id} - Obtener Lote por ID'
description: 'Documentación para obtener los detalles de un lote específico'
---

# 📦 GET /invoices/batches/{id} - Obtener Lote por ID

Este endpoint te permite obtener los detalles completos de un lote específico, incluyendo todos sus items.

## URL Base

```
https://facture.ar/api/invoices/batches/{id}
```

## Autenticación

Todas las peticiones requieren autenticación usando:

- **Sesión Web**: Para aplicaciones basadas en navegador
- **API Key**: Para integraciones servidor a servidor

Incluye tu API key en el header `x-api-key`:

```bash
x-api-key: tu-api-key-aqui
```

## Parámetros de Ruta

| Parámetro | Tipo   | Requerido | Descripción       | Ejemplo                                  |
| --------- | ------ | --------- | ----------------- | ---------------------------------------- |
| `id`      | string | ✅        | ID único del lote | `"123e4567-e89b-12d3-a456-426614174000"` |

## Respuesta

### Éxito (200)

```json
{
  "id": "123e4567-e89b-12d3-a456-426614174000",
  "status": "completed",
  "totalItems": 5,
  "processedItems": 5,
  "successfulItems": 4,
  "failedItems": 1,
  "environment": "production",
  "createdAt": "2024-01-01T10:00:00Z",
  "updatedAt": "2024-01-01T10:05:00Z",
  "items": [
    {
      "id": "456e7890-e89b-12d3-a456-426614174001",
      "status": "completed",
      "order": 1,
      "createdAt": "2024-01-01T10:00:00Z",
      "updatedAt": "2024-01-01T10:01:00Z",
      "requestBody": {
        "amount": 1000.0,
        "description": "Venta de servicios",
        "cuitId": "789e0123-e89b-12d3-a456-426614174002"
      },
      "responseBody": {
        "success": true,
        "invoiceId": "abc12345-e89b-12d3-a456-426614174003",
        "cae": "12345678901234",
        "voucherNumber": 1
      },
      "cuit": {
        "id": "789e0123-e89b-12d3-a456-426614174002",
        "number": "20-12345678-9"
      }
    },
    {
      "id": "def67890-e89b-12d3-a456-426614174004",
      "status": "error",
      "order": 2,
      "createdAt": "2024-01-01T10:00:01Z",
      "updatedAt": "2024-01-01T10:01:30Z",
      "requestBody": {
        "amount": 2000.0,
        "description": "Venta de productos",
        "cuitId": "789e0123-e89b-12d3-a456-426614174002"
      },
      "responseBody": {
        "error": "Validation error",
        "details": "Invalid amount format"
      },
      "cuit": {
        "id": "789e0123-e89b-12d3-a456-426614174002",
        "number": "20-12345678-9"
      }
    }
  ]
}
```

### Respuestas de Error

#### Lote No Encontrado (404)

```json
{
  "error": "Lote no encontrado",
  "details": "The requested batch does not exist or you don't have access to it"
}
```

#### No Autorizado (403)

```json
{
  "error": "No autorizado",
  "details": "You don't have access to this batch"
}
```

#### Error del Servidor (500)

```json
{
  "error": "Internal server error",
  "details": "Failed to fetch batch"
}
```

## Campos de Respuesta

### Lote (Batch)

| Campo             | Tipo   | Descripción                              |
| ----------------- | ------ | ---------------------------------------- |
| `id`              | string | ID único del lote                        |
| `status`          | string | Estado del lote                          |
| `totalItems`      | number | Total de items en el lote                |
| `processedItems`  | number | Items procesados                         |
| `successfulItems` | number | Items exitosos                           |
| `failedItems`     | number | Items fallidos                           |
| `environment`     | string | Ambiente (production/homologation)       |
| `createdAt`       | string | Fecha de creación (ISO 8601)             |
| `updatedAt`       | string | Fecha de última actualización (ISO 8601) |
| `items`           | array  | Items del lote                           |

### Item del Lote

| Campo          | Tipo   | Descripción                              |
| -------------- | ------ | ---------------------------------------- |
| `id`           | string | ID único del item                        |
| `status`       | string | Estado del item                          |
| `order`        | number | Orden en el lote                         |
| `createdAt`    | string | Fecha de creación (ISO 8601)             |
| `updatedAt`    | string | Fecha de última actualización (ISO 8601) |
| `requestBody`  | object | Datos de la factura original             |
| `responseBody` | object | Respuesta del procesamiento              |
| `cuit`         | object | Información del CUIT (id, number)        |

## Estados de Lote

| Estado                  | Descripción                          |
| ----------------------- | ------------------------------------ |
| `pending`               | Lote creado, esperando procesamiento |
| `processing`            | Lote en proceso                      |
| `completed`             | Lote procesado completamente         |
| `completed_with_errors` | Lote procesado con algunos errores   |
| `error`                 | Lote falló completamente             |

## Estados de Item

| Estado       | Descripción                    |
| ------------ | ------------------------------ |
| `pending`    | Item en cola                   |
| `processing` | Item siendo procesado          |
| `completed`  | Item procesado exitosamente    |
| `error`      | Item falló en el procesamiento |

## Ejemplos de Uso

### cURL

```bash
curl -X GET https://facture.ar/api/invoices/batches/123e4567-e89b-12d3-a456-426614174000 \
  -H "x-api-key: tu-api-key"
```

### JavaScript/Node.js

```javascript
const response = await fetch('https://facture.ar/api/invoices/batches/123e4567-e89b-12d3-a456-426614174000', {
  method: 'GET',
  headers: {
    'x-api-key': 'tu-api-key',
  },
});

const batch = await response.json();
console.log('Lote:', batch);

// Verificar estado del lote
if (batch.status === 'completed') {
  console.log(`Lote completado: ${batch.successfulItems}/${batch.totalItems} exitosos`);
} else if (batch.status === 'completed_with_errors') {
  console.log(`Lote completado con errores: ${batch.failedItems} fallidos`);
}

// Filtrar items con errores
const failedItems = batch.items.filter(item => item.status === 'error');
console.log('Items con errores:', failedItems);
```

### Python

```python
import requests

response = requests.get(
    'https://facture.ar/api/invoices/batches/123e4567-e89b-12d3-a456-426614174000',
    headers={
        'x-api-key': 'tu-api-key'
    }
)

batch = response.json()
print('Lote:', batch)

# Verificar estado del lote
if batch['status'] == 'completed':
    print(f"Lote completado: {batch['successfulItems']}/{batch['totalItems']} exitosos")
elif batch['status'] == 'completed_with_errors':
    print(f"Lote completado con errores: {batch['failedItems']} fallidos")

# Filtrar items con errores
failed_items = [item for item in batch['items'] if item['status'] == 'error']
print('Items con errores:', failed_items)
```

## ❓ Solución de Problemas

<Accordion title="Error: Lote no encontrado">
**Causa**: El ID del lote no existe o no tienes acceso a él.

**Solución**:

1. Verifica que el ID del lote sea correcto
2. Asegúrate de que el lote pertenezca a tu cuenta
3. Verifica que estés usando la API key correcta

</Accordion>

<Accordion title="Error: No autorizado">
**Causa**: No tienes permisos para acceder a este lote.

**Solución**:

1. Verifica que el lote pertenezca a tu cuenta
2. Asegúrate de estar usando la API key correcta
3. Contacta soporte si el problema persiste

</Accordion>

<Accordion title="Error: Items con errores">
**Causa**: Algunos items del lote fallaron en el procesamiento.

**Solución**:

1. Revisa los detalles del error en `responseBody`
2. Corrige los datos y reintenta los items fallidos
3. Usa el endpoint de retry para reintentar items específicos
</Accordion>

## 📞 Soporte

Para soporte técnico o preguntas sobre la API:

- 📧 **Email**: support@facture.ar
- 💬 **Chat**: Disponible en la plataforma
- 📚 **Documentación**: Explora nuestros ejemplos detallados
- 🎥 **Videollamada**: Para asistencia personalizada
